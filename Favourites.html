<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>Family Caller</title>
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet" />
<style>
  :root {
    --cream: #FDF6EC;
    --warm-white: #FFFAF4;
    --sand: #F0E4CE;
    --gold: #D4943A;
    --gold-light: #F2C46D;
    --gold-dark: #A8721F;
    --green: #4A8C5C;
    --green-light: #6DB88A;
    --red: #C0392B;
    --red-light: #E05C4B;
    --text-dark: #2C1F0E;
    --text-mid: #5C4A2A;
    --text-light: #8C7A60;
    --shadow-soft: 0 4px 24px rgba(44,31,14,0.10);
    --shadow-card: 0 6px 32px rgba(44,31,14,0.13);
    --radius: 24px;
    --radius-sm: 16px;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }

  body {
    font-family: 'Nunito', sans-serif;
    background: var(--cream);
    color: var(--text-dark);
    min-height: 100vh;
    max-width: 430px;
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    background-image:
      radial-gradient(ellipse at 10% 0%, rgba(212,148,58,0.08) 0%, transparent 60%),
      radial-gradient(ellipse at 90% 100%, rgba(74,140,92,0.07) 0%, transparent 60%);
  }

  /* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
  header {
    background: var(--warm-white);
    padding: 24px 24px 18px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    border-bottom: 2px solid var(--sand);
    box-shadow: 0 2px 12px rgba(44,31,14,0.06);
    position: sticky;
    top: 0;
    z-index: 100;
  }

  .header-title {
    font-family: 'Nunito', sans-serif;
    font-size: 28px;
    font-weight: 900;
    color: var(--text-dark);
    letter-spacing: -0.3px;
  }
  .header-title span { color: var(--gold); }

  .add-btn {
    background: var(--gold);
    color: white;
    border: none;
    border-radius: 50%;
    width: 52px;
    height: 52px;
    font-size: 30px;
    cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    box-shadow: 0 3px 12px rgba(168,114,31,0.35);
    transition: background 0.15s, transform 0.1s;
    flex-shrink: 0;
  }
  .add-btn:active { background: var(--gold-dark); transform: scale(0.94); }

  /* ‚îÄ‚îÄ GREETING ‚îÄ‚îÄ */
  .greeting {
    padding: 22px 24px 4px;
    font-size: 20px;
    color: var(--text-mid);
    font-weight: 600;
  }
  .greeting strong {
    display: block;
    font-size: 17px;
    font-weight: 600;
    color: var(--text-light);
    margin-top: 2px;
  }

  /* ‚îÄ‚îÄ CONTACT LIST ‚îÄ‚îÄ */
  .contacts {
    padding: 12px 20px 120px;
    display: flex;
    flex-direction: column;
    gap: 14px;
    flex: 1;
  }

  .contact-card {
    background: var(--warm-white);
    border-radius: var(--radius);
    box-shadow: var(--shadow-card);
    display: flex;
    align-items: center;
    gap: 0;
    overflow: hidden;
    cursor: pointer;
    border: 2px solid transparent;
    transition: transform 0.12s, box-shadow 0.12s, border-color 0.12s;
    min-height: 100px;
  }
  .contact-card:active {
    transform: scale(0.97);
    box-shadow: 0 2px 10px rgba(44,31,14,0.10);
    border-color: var(--green-light);
  }

  .contact-photo {
    width: 100px;
    height: 100px;
    flex-shrink: 0;
    object-fit: cover;
    background: var(--sand);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 44px;
    font-weight: 800;
    color: var(--gold);
    user-select: none;
  }
  .contact-photo img {
    width: 100%; height: 100%;
    object-fit: cover;
    display: block;
  }

  .contact-info {
    flex: 1;
    padding: 18px 14px 18px 18px;
    display: flex;
    flex-direction: column;
    gap: 4px;
  }
  .contact-name {
    font-family: 'Nunito', sans-serif;
    font-size: 26px;
    font-weight: 900;
    color: var(--text-dark);
    line-height: 1.15;
  }
  .contact-number {
    font-size: 16px;
    color: var(--text-light);
    font-weight: 600;
  }

  .call-pill {
    background: var(--green);
    color: white;
    border-radius: 50px;
    padding: 10px 18px;
    font-size: 16px;
    font-weight: 800;
    display: flex;
    align-items: center;
    gap: 6px;
    margin-right: 16px;
    box-shadow: 0 2px 8px rgba(74,140,92,0.3);
    flex-shrink: 0;
    white-space: nowrap;
  }

  /* ‚îÄ‚îÄ EMPTY STATE ‚îÄ‚îÄ */
  .empty-state {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 16px;
    padding: 60px 30px;
    text-align: center;
  }
  .empty-icon { font-size: 72px; opacity: 0.35; }
  .empty-text {
    font-family: 'Nunito', sans-serif;
    font-size: 24px;
    color: var(--text-mid);
    font-weight: 800;
    line-height: 1.3;
  }
  .empty-sub {
    font-size: 18px;
    color: var(--text-light);
    font-weight: 600;
    max-width: 260px;
  }
  .empty-arrow {
    font-size: 36px;
    color: var(--gold);
    animation: bounce 1.6s ease-in-out infinite;
  }
  @keyframes bounce {
    0%,100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
  }

  /* ‚îÄ‚îÄ MODAL OVERLAY ‚îÄ‚îÄ */
  .overlay {
    position: fixed;
    inset: 0;
    background: rgba(44,31,14,0.55);
    backdrop-filter: blur(4px);
    z-index: 200;
    display: flex;
    align-items: flex-end;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.25s;
  }
  .overlay.visible {
    opacity: 1;
    pointer-events: all;
  }

  /* ‚îÄ‚îÄ MODAL SHEET ‚îÄ‚îÄ */
  .sheet {
    background: var(--warm-white);
    border-radius: 28px 28px 0 0;
    width: 100%;
    max-width: 430px;
    margin: 0 auto;
    padding: 0 0 40px;
    transform: translateY(100%);
    transition: transform 0.3s cubic-bezier(0.32,0.72,0,1);
    box-shadow: 0 -8px 40px rgba(44,31,14,0.18);
    max-height: 92vh;
    overflow-y: auto;
  }
  .overlay.visible .sheet {
    transform: translateY(0);
  }

  .sheet-handle {
    width: 44px;
    height: 5px;
    background: var(--sand);
    border-radius: 99px;
    margin: 14px auto 0;
  }

  .sheet-header {
    padding: 20px 24px 16px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    border-bottom: 2px solid var(--sand);
  }
  .sheet-title {
    font-family: 'Nunito', sans-serif;
    font-size: 24px;
    font-weight: 900;
    color: var(--text-dark);
  }
  .sheet-close {
    background: var(--sand);
    border: none;
    border-radius: 50%;
    width: 40px; height: 40px;
    font-size: 20px;
    cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    color: var(--text-mid);
    transition: background 0.15s;
  }
  .sheet-close:active { background: #e0d0ba; }

  /* ‚îÄ‚îÄ PHOTO PICKER ‚îÄ‚îÄ */
  .photo-picker-area {
    padding: 24px 24px 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 14px;
  }

  .photo-preview {
    width: 130px;
    height: 130px;
    border-radius: var(--radius);
    background: var(--sand);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 60px;
    overflow: hidden;
    border: 3px dashed var(--gold-light);
    position: relative;
  }
  .photo-preview img {
    width: 100%; height: 100%;
    object-fit: cover;
    display: block;
  }
  .photo-placeholder-text {
    position: absolute;
    bottom: 8px;
    font-size: 12px;
    font-weight: 700;
    color: var(--text-light);
    text-align: center;
  }

  .photo-btns {
    display: flex;
    gap: 12px;
    width: 100%;
  }
  .photo-btn {
    flex: 1;
    background: var(--sand);
    border: none;
    border-radius: var(--radius-sm);
    padding: 14px 10px;
    font-family: 'Nunito', sans-serif;
    font-size: 16px;
    font-weight: 700;
    color: var(--text-mid);
    cursor: pointer;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
    transition: background 0.15s;
  }
  .photo-btn:active { background: #e0d0ba; }
  .photo-btn .btn-icon { font-size: 26px; }

  /* Hidden file input */
  #fileInput, #cameraInput { display: none; }

  /* ‚îÄ‚îÄ FORM FIELDS ‚îÄ‚îÄ */
  .form-fields {
    padding: 20px 24px 0;
    display: flex;
    flex-direction: column;
    gap: 16px;
  }

  .field-label {
    font-size: 15px;
    font-weight: 700;
    color: var(--text-light);
    text-transform: uppercase;
    letter-spacing: 0.8px;
    margin-bottom: 6px;
    display: block;
  }

  .field-input {
    width: 100%;
    background: var(--sand);
    border: 2.5px solid transparent;
    border-radius: var(--radius-sm);
    padding: 16px 18px;
    font-family: 'Nunito', sans-serif;
    font-size: 22px;
    font-weight: 700;
    color: var(--text-dark);
    outline: none;
    transition: border-color 0.2s, background 0.2s;
    -webkit-appearance: none;
  }
  .field-input:focus {
    border-color: var(--gold);
    background: white;
  }
  .field-input::placeholder { color: var(--text-light); font-weight: 600; }

  /* ‚îÄ‚îÄ SAVE BUTTON ‚îÄ‚îÄ */
  .save-btn {
    margin: 24px 24px 0;
    width: calc(100% - 48px);
    background: var(--green);
    color: white;
    border: none;
    border-radius: var(--radius);
    padding: 20px;
    font-family: 'Nunito', sans-serif;
    font-size: 22px;
    font-weight: 800;
    cursor: pointer;
    box-shadow: 0 4px 16px rgba(74,140,92,0.3);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    transition: background 0.15s, transform 0.1s;
  }
  .save-btn:active { background: #3a7048; transform: scale(0.97); }
  .save-btn:disabled { background: var(--text-light); box-shadow: none; cursor: not-allowed; }

  /* ‚îÄ‚îÄ DELETE BUTTON ‚îÄ‚îÄ */
  .delete-btn {
    margin: 12px 24px 0;
    width: calc(100% - 48px);
    background: transparent;
    color: var(--red);
    border: 2.5px solid var(--red);
    border-radius: var(--radius);
    padding: 16px;
    font-family: 'Nunito', sans-serif;
    font-size: 20px;
    font-weight: 800;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    transition: background 0.15s;
  }
  .delete-btn:active { background: #fce8e6; }

  /* ‚îÄ‚îÄ CALL FLASH ‚îÄ‚îÄ */
  .call-flash {
    position: fixed;
    inset: 0;
    background: var(--green);
    z-index: 500;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 20px;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s;
  }
  .call-flash.visible {
    opacity: 1;
    pointer-events: all;
  }
  .call-flash-photo {
    width: 160px; height: 160px;
    border-radius: 50%;
    background: rgba(255,255,255,0.2);
    overflow: hidden;
    display: flex; align-items: center; justify-content: center;
    font-size: 70px; color: white;
    border: 5px solid rgba(255,255,255,0.5);
    animation: ringPulse 1.5s ease-in-out infinite;
  }
  .call-flash-photo img { width: 100%; height: 100%; object-fit: cover; }
  @keyframes ringPulse {
    0%,100% { box-shadow: 0 0 0 0 rgba(255,255,255,0.4); }
    50% { box-shadow: 0 0 0 20px rgba(255,255,255,0); }
  }
  .call-flash-name {
    font-family: 'Nunito', sans-serif;
    font-size: 38px;
    font-weight: 900;
    color: white;
  }
  .call-flash-label {
    font-size: 20px;
    color: rgba(255,255,255,0.8);
    font-weight: 600;
  }
  .end-btn {
    margin-top: 20px;
    background: var(--red);
    border: none;
    border-radius: 50%;
    width: 80px; height: 80px;
    font-size: 34px;
    color: white;
    cursor: pointer;
    display: flex; align-items: center; justify-content: center;
    box-shadow: 0 4px 20px rgba(192,57,43,0.4);
  }
</style>
</head>
<body>

<!-- ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ -->
<header>
  <div class="header-title">My <span>Favourites</span></div>
  <button class="add-btn" onclick="openAdd()" aria-label="Add favourite">Ôºã</button>
</header>

<!-- ‚îÄ‚îÄ CONTACT LIST ‚îÄ‚îÄ -->
<div id="contactsWrap">
  <!-- filled by JS -->
</div>

<!-- ‚îÄ‚îÄ ADD / EDIT MODAL ‚îÄ‚îÄ -->
<div class="overlay" id="overlay" onclick="handleOverlayClick(event)">
  <div class="sheet" id="sheet">
    <div class="sheet-handle"></div>
    <div class="sheet-header">
      <span class="sheet-title" id="sheetTitle">Add Favourite</span>
      <button class="sheet-close" onclick="closeSheet()">‚úï</button>
    </div>

    <!-- Photo picker -->
    <div class="photo-picker-area">
      <div class="photo-preview" id="photoPreview">
        üì∑
        <span class="photo-placeholder-text">No photo yet</span>
      </div>
      <div class="photo-btns">
        <button class="photo-btn" onclick="document.getElementById('cameraInput').click()">
          <span class="btn-icon">üì∏</span>
          Take Photo
        </button>
        <button class="photo-btn" onclick="document.getElementById('fileInput').click()">
          <span class="btn-icon">üñºÔ∏è</span>
          Photo Library
        </button>
      </div>
      <input type="file" id="fileInput" accept="image/*" onchange="handlePhoto(event)" />
      <input type="file" id="cameraInput" accept="image/*" capture="environment" onchange="handlePhoto(event)" />
    </div>

    <!-- Form fields -->
    <div class="form-fields">
      <div>
        <label class="field-label" for="nameInput">Their Name</label>
        <input class="field-input" id="nameInput" type="text" placeholder="e.g. Sarah" autocomplete="off" oninput="checkForm()" />
      </div>
      <div>
        <label class="field-label" for="phoneInput">Phone Number</label>
        <input class="field-input" id="phoneInput" type="tel" placeholder="e.g. 555-123-4567" autocomplete="off" oninput="checkForm()" />
      </div>
    </div>

    <button class="save-btn" id="saveBtn" onclick="savePerson()" disabled>
      ‚úì &nbsp;Save
    </button>
    <button class="delete-btn" id="deleteBtn" onclick="deletePerson()" style="display:none;">
      üóë &nbsp;Remove
    </button>
  </div>
</div>

<!-- ‚îÄ‚îÄ CALLING SCREEN ‚îÄ‚îÄ -->
<div class="call-flash" id="callFlash">
  <div class="call-flash-photo" id="callPhoto"></div>
  <div class="call-flash-name" id="callName"></div>
  <div class="call-flash-label">Calling‚Ä¶</div>
  <button class="end-btn" onclick="endCall()">üìµ</button>
</div>

<script>
// ‚îÄ‚îÄ DATA ‚îÄ‚îÄ
let contacts = JSON.parse(localStorage.getItem('familyCaller') || '[]');
let editingIndex = -1;
let pendingPhoto = null;

// ‚îÄ‚îÄ RENDER ‚îÄ‚îÄ
function render() {
  const wrap = document.getElementById('contactsWrap');
  if (contacts.length === 0) {
    wrap.innerHTML = `
      <div class="empty-state">
        <div class="empty-icon">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</div>
        <div class="empty-text">No favourites yet</div>
        <div class="empty-sub">Tap the + button above to add someone</div>
        <div class="empty-arrow">‚òùÔ∏è</div>
      </div>`;
    return;
  }
  wrap.innerHTML = `<div class="contacts">${contacts.map((c, i) => `
    <div class="contact-card" onclick="callContact(${i})">
      <div class="contact-photo">
        ${c.photo ? `<img src="${c.photo}" alt="${c.name}" />` : initials(c.name)}
      </div>
      <div class="contact-info">
        <div class="contact-name">${esc(c.name)}</div>
        <div class="contact-number">${esc(c.phone)}</div>
      </div>
      <div class="call-pill">üìû Call</div>
    </div>
    <button onclick="event.stopPropagation(); openEdit(${i})" style="
      background: none; border: none; font-size: 13px; font-weight: 700;
      color: var(--text-light); text-align: right; padding: 0 20px 6px;
      cursor: pointer; font-family: Nunito, sans-serif; display: block; width: 100%;
    ">‚úèÔ∏è Edit</button>
  `).join('')}</div>`;
}

function initials(name) {
  return (name || '?').split(' ').map(w => w[0]).slice(0, 2).join('').toUpperCase();
}
function esc(s) {
  return (s || '').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
}

// ‚îÄ‚îÄ CALL ‚îÄ‚îÄ
function callContact(i) {
  const c = contacts[i];
  const flash = document.getElementById('callFlash');
  const photo = document.getElementById('callPhoto');
  const name  = document.getElementById('callName');
  name.textContent = c.name;
  photo.innerHTML = c.photo ? `<img src="${c.photo}" />` : initials(c.name);
  flash.classList.add('visible');
  // Actually dial on real device
  setTimeout(() => { window.location.href = `tel:${c.phone.replace(/\D/g,'')}`; }, 400);
}
function endCall() {
  document.getElementById('callFlash').classList.remove('visible');
}

// ‚îÄ‚îÄ MODAL ‚îÄ‚îÄ
function openAdd() {
  editingIndex = -1;
  pendingPhoto = null;
  document.getElementById('sheetTitle').textContent = 'Add Favourite';
  document.getElementById('nameInput').value = '';
  document.getElementById('phoneInput').value = '';
  resetPhotoPreview();
  document.getElementById('deleteBtn').style.display = 'none';
  document.getElementById('saveBtn').disabled = true;
  document.getElementById('overlay').classList.add('visible');
}
function openEdit(i) {
  const c = contacts[i];
  editingIndex = i;
  pendingPhoto = c.photo || null;
  document.getElementById('sheetTitle').textContent = 'Edit ' + c.name;
  document.getElementById('nameInput').value = c.name;
  document.getElementById('phoneInput').value = c.phone;
  const pp = document.getElementById('photoPreview');
  if (c.photo) {
    pp.innerHTML = `<img src="${c.photo}" alt="photo" />`;
  } else {
    resetPhotoPreview();
  }
  document.getElementById('deleteBtn').style.display = '';
  document.getElementById('saveBtn').disabled = false;
  document.getElementById('overlay').classList.add('visible');
}
function closeSheet() {
  document.getElementById('overlay').classList.remove('visible');
}
function handleOverlayClick(e) {
  if (e.target === document.getElementById('overlay')) closeSheet();
}

// ‚îÄ‚îÄ PHOTO ‚îÄ‚îÄ
function handlePhoto(e) {
  const file = e.target.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = function(ev) {
    pendingPhoto = ev.target.result;
    const pp = document.getElementById('photoPreview');
    pp.innerHTML = `<img src="${pendingPhoto}" alt="preview" />`;
    e.target.value = '';
  };
  reader.readAsDataURL(file);
}
function resetPhotoPreview() {
  document.getElementById('photoPreview').innerHTML = `üì∑<span class="photo-placeholder-text">No photo yet</span>`;
}

// ‚îÄ‚îÄ FORM VALIDATION ‚îÄ‚îÄ
function checkForm() {
  const name  = document.getElementById('nameInput').value.trim();
  const phone = document.getElementById('phoneInput').value.trim();
  document.getElementById('saveBtn').disabled = !(name && phone);
}

// ‚îÄ‚îÄ SAVE / DELETE ‚îÄ‚îÄ
function savePerson() {
  const name  = document.getElementById('nameInput').value.trim();
  const phone = document.getElementById('phoneInput').value.trim();
  if (!name || !phone) return;
  const person = { name, phone, photo: pendingPhoto };
  if (editingIndex >= 0) {
    contacts[editingIndex] = person;
  } else {
    contacts.push(person);
  }
  save();
  closeSheet();
  render();
}
function deletePerson() {
  if (editingIndex < 0) return;
  if (!confirm(`Remove ${contacts[editingIndex].name}?`)) return;
  contacts.splice(editingIndex, 1);
  save();
  closeSheet();
  render();
}
function save() {
  localStorage.setItem('familyCaller', JSON.stringify(contacts));
}

// ‚îÄ‚îÄ INIT ‚îÄ‚îÄ
render();
</script>
</body>
</html>
